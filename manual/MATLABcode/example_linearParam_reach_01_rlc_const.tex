% This file was automatically created from the m-file 
% "m2tex.m" written by USL. 
% The fontencoding in this file is UTF-8. 
%  
% You will need to include the following two packages in 
% your LaTeX-Main-File. 
%  
% \usepackage{color} 
% \usepackage{fancyvrb} 
%  
% It is advised to use the following option for Inputenc 
% \usepackage[utf8]{inputenc} 
%  
  
% definition of matlab colors: 
\definecolor{mblue}{rgb}{0,0,1} 
\definecolor{mgreen}{rgb}{0.13333,0.5451,0.13333} 
\definecolor{mred}{rgb}{0.62745,0.12549,0.94118} 
\definecolor{mgrey}{rgb}{0.5,0.5,0.5} 
\definecolor{mdarkgrey}{rgb}{0.25,0.25,0.25} 
  
\DefineShortVerb[fontfamily=courier,fontseries=m]{\$} 
\DefineShortVerb[fontfamily=courier,fontseries=b]{\#} 
  
\noindent                                                                                                             
 $$\color{mgreen}$% System Dynamics ---------------------------------------------------------$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% get matrix zonotopes of the model$\color{black}$$\\
 $[matZ_A,matZ_B] = RLCcircuit();$\\
 $matI_A = intervalMatrix(matZ_A);$\\
 $dim = matZ_A.dim;$\\
 $$\\
 $$\color{mgreen}$% create linear parametric systems with constant parameters$\color{black}$$\\
 $sysMatZono  = linParamSys(matZ_A, eye(dim));$\\
 $sysIntMat = linParamSys(matI_A, eye(dim));$\\
 $$\\
 $$\\
 $$\color{mgreen}$% Parameter ---------------------------------------------------------------$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% compute initial set$\color{black}$$\\
 $u0 = intervalMatrix(0,0.2);             $\color{mgreen}$% range of voltages$\color{black}$$\\
 $$\\
 $intA = intervalMatrix(matZ_A);$\\
 $invAmid = inv(center(intA.int));        $\color{mgreen}$% inverse of A$\color{black}$$\\
 $$\\
 $intB = intervalMatrix(matZ_B);$\\
 $R0 = invAmid*intB*u0 + intervalMatrix(0,1e-3*ones(dim,1));$\\
 $$\\
 $params.R0 = zonotope(interval(R0));     $\color{mgreen}$% convert initial set to zonotope$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% uncertain inputs$\color{black}$$\\
 $u = intervalMatrix(1,0.01);$\\
 $params.U = zonotope(interval(intB*u));$\\
 $$\\
 $$\color{mgreen}$% final time$\color{black}$$\\
 $params.tFinal = 0.3;$\\
 $$\\
 $$\\
 $$\color{mgreen}$% Reachability Settings ---------------------------------------------------$\color{black}$$\\
 $$\\
 $options.intermediateOrder = 2;$\\
 $options.timeStep = 0.001;$\\
 $options.zonotopeOrder = 400;$\\
 $options.taylorTerms = 8;$\\
 $options.compTimePoint = false;$\\
 $$\\
 $$\\
 $$\color{mgreen}$% Reachability Analysis ---------------------------------------------------$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% compute reachable set using matrix zonotopes$\color{black}$$\\
 $tic$\\
 $RmatZono = reach(sysMatZono, params, options);$\\
 $tComp = toc;$\\
 $disp([$\color{mred}$'computation time (matrix zonotopes): '$\color{black}$,num2str(tComp)]);$\\
 $$\\
 $$\color{mgreen}$% compute reachable set using interval matrices$\color{black}$$\\
 $tic$\\
 $RintMat = reach(sysIntMat, params, options);$\\
 $tComp = toc;$\\
 $disp([$\color{mred}$'computation time (interval matrices): '$\color{black}$,num2str(tComp)]);$\\
 $$\\
 $$\\
 $$\color{mgreen}$% Simulation --------------------------------------------------------------$\color{black}$$\\
 $$\\
 $simOpt.points = 60;$\\
 $simOpt.fracVert = 0.5;$\\
 $simOpt.fracInpVert = 0.5;$\\
 $simOpt.nrConstInp = 6;$\\
 $$\\
 $simRes = simulateRandom(sysIntMat, params, simOpt);$\\
 $$\\
 $$\\
 $$\color{mgreen}$% Visualization -----------------------------------------------------------$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% PLOT 1: state space$\color{black}$$\\
 $$\\
 $figure; $\\
 $hold $\color{mred}$on$\color{black}$$\\
 $projDim = [20,40];$\\
 $    $\\
 $$\color{mgreen}$% plot reachable sets$\color{black}$$\\
 $hanIntMat = plot(RintMat,projDim,$\color{mred}$'FaceColor'$\color{black}$,[.6 .6 .6],$\color{mred}$'Order'$\color{black}$,10);$\\
 $hanMatZono = plot(RmatZono,projDim,$\color{mred}$'FaceColor'$\color{black}$,[.8 .8 .8],$\color{mred}$'Order'$\color{black}$,10);$\\
 $$\\
 $$\color{mgreen}$% plot initial set$\color{black}$$\\
 $plot(params.R0,projDim,$\color{mred}$'k'$\color{black}$,$\color{mred}$'FaceColor'$\color{black}$,$\color{mred}$'k'$\color{black}$);$\\
 $$\\
 $$\color{mgreen}$% plot simulation results     $\color{black}$$\\
 $plot(simRes,projDim);$\\
 $$\\
 $$\color{mgreen}$% label plot$\color{black}$$\\
 $xlabel([$\color{mred}$'x_{'$\color{black}$,num2str(projDim(1)),$\color{mred}$'}'$\color{black}$]);$\\
 $ylabel([$\color{mred}$'x_{'$\color{black}$,num2str(projDim(2)),$\color{mred}$'}'$\color{black}$]);$\\
 $legend([hanIntMat,hanMatZono],$\color{mred}$'Interval matrix'$\color{black}$,$\color{mred}$'Matrix zonotope'$\color{black}$);$\\
 $$\\
 $$\\
 $$\color{mgreen}$% PLOT 2: reachable set over time$\color{black}$$\\
 $$\\
 $figure; $\\
 $hold $\color{mred}$on$\color{black}$$\\
 $$\\
 $$\color{mgreen}$% plot time elapse$\color{black}$$\\
 $hanIntMat = plotOverTime(RintMat,0.5*dim,$\color{mred}$'FaceColor'$\color{black}$,[.6 .6 .6]);$\\
 $hanMatZono = plotOverTime(RmatZono,0.5*dim,$\color{mred}$'FaceColor'$\color{black}$,[.8 .8 .8]);$\\
 $$\\
 $$\color{mgreen}$% plot simulation results$\color{black}$$\\
 $plotOverTime(simRes,0.5*dim);$\\
 $$\\
 $$\color{mgreen}$% label plot$\color{black}$$\\
 $xlabel($\color{mred}$'t'$\color{black}$);$\\
 $ylabel([$\color{mred}$'x_{'$\color{black}$,num2str(0.5*dim),$\color{mred}$'}'$\color{black}$]);$\\
 $legend([hanIntMat,hanMatZono],$\color{mred}$'Interval matrix'$\color{black}$,$\color{mred}$'Matrix zonotope'$\color{black}$);$\\ 
  
\UndefineShortVerb{\$} 
\UndefineShortVerb{\#}