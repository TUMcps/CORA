\subsubsection{reachBackward} \label{sec:reachBackward}

The operation \operator{reachBackward} computes the backward reachable set of a dynamic system. Let us denote the solution of a dynamic system by $\chi(t;x_0,u(\cdot),w(\cdot))$, where $t\in\mathbb{R}$ is the time, $x_0 = x(t_0) \in \mathbb{R}^n$ is the initial state, $u(\cdot) \in \mathbb{R}^m$ is the control input, and $w \in \mathbb{R}^r$ is the disturbance.
Given a target set $\mathcal{X}_0 \subset \Rn$, a set of input values $\mathcal{U}(t) \subset \R^m$, a set of disturbance values $\mathcal{W}(t) \subset \R^r$, a time interval $\tau$, we can define two backward reachable sets, depending on the quantifiers used for control inputs and disturbances:
\begin{align}
  \mathcal{R}_{AE}(-\tau) = \Big\{ x_0 \in \mathbb{R}^n ~\big|~ \forall u(t)\in\mathcal{U}(t), \exists w \in \mathcal{W}, \exists t \in \tau\colon \chi(t;x_0,u(\cdot),w(\cdot)) \in \mathcal{X}_0 \Big\}.
  \label{eq:reachBackward_AE} \\
  \mathcal{R}_{EA}(-\tau) = \Big\{ x_0 \in \mathbb{R}^n ~\big|~ \exists w \in \mathcal{W}, \forall u(t)\in\mathcal{U}(t), \exists t \in \tau\colon \chi(t;x_0,u(\cdot),w(\cdot)) \in \mathcal{X}_0 \Big\}.
  \label{eq:reachBackward_EA}
\end{align}
Please note that the time interval $\tau$ may also be a single point in time.
Since the exact reachable set $\mathcal{R}^e(t)$ as defined in \eqref{eq:reachSet} cannot be computed in general, the operation \texttt{reach} computes a tight enclosure $\mathcal{R}(t) \supseteq \mathcal{R}^e(t)$.

The syntax for the operation \texttt{reachBackward} is:
\begin{equation*}
\begin{split}
	& \texttt{R} = \texttt{reachBackward}(\texttt{sys},\texttt{params},\texttt{options}) ,
\end{split}
\end{equation*}
with input arguments

\begin{center}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}[t]{l p{13cm} }
	$\bullet$~\texttt{sys} & dynamic system as an object of class \texttt{linearSys} \\
	$\bullet$~\texttt{params} & struct containing the parameters that define the reachability problem \\
	& \begin{tabular}[t]{l p{10cm}}	
	 	--~\texttt{.tStart} & initial time $t_0$ (default value 0) \\
	 	--~\texttt{.tFinal} & final time $t_f$ \\
	 	--~\texttt{.R0} & initial set $\mathcal{X}_0$ specified by a polytope (see \cref{sec:polytope}) \\
	 	--~\texttt{.U} & input set $\mathcal{U}$ specified as an object of class \texttt{interval} (see \cref{sec:interval}) or \texttt{zonotope} (see \cref{sec:zonotope})\\
	 	--~\texttt{.W} & disturbance set $\mathcal{W}$ specified as an object of class \texttt{interval} (see \cref{sec:interval}) or \texttt{zonotope} (see \cref{sec:zonotope}) \\
	 \end{tabular}
\end{tabular}
\end{center}
\begin{center}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}[t]{l p{13cm} }
	$\bullet$~\texttt{options} & struct containing algorithm settings for reachability analysis. Since the settings are different for each type of dynamic system, they are documented in \cref{sec:continuousDynamics} and \cref{sec:hybridDynamics}. \\
	& \begin{tabular}[t]{l p{10cm}}	
		--~\texttt{.timeStep} & time step size \\
		--~\texttt{.linAlg} & string specifying the used reachability algorithm following the pattern \texttt{<inner|outer>:<AE|EA>:<timepoint|timeinterval>}, where the first part refers to computing inner or outer approximations, the second part to the AE backward reachable set \eqref{eq:reachBackward_AE} or EA backward reachable set \eqref{eq:reachBackward_EA}, and the third part to computing time-point or time-interval solutions.
		\end{tabular} \\
\end{tabular}
\end{center}

and output arguments

\begin{center}
\renewcommand{\arraystretch}{1.3}
\begin{tabular}[t]{l p{13cm} }
	$\bullet$~\texttt{R} & object of class \texttt{reachSet} (see \cref{sec:reachSet}) that stores the backward reachable set $\mathcal{R}(t_i)$ at time point $t_i$ and the reachable set $\mathcal{R}(\tau_i)$ for time intervals $\tau_i = [t_i,t_{i+1}]$.
\end{tabular}
\end{center}

Let us demonstrate the operation \texttt{reachBackward} by an example:

\begin{center}
\begin{minipage}[t]{0.58\textwidth}
	\footnotesize
	\input{./MATLABcode/example_reachBackward}
\end{minipage}
% \begin{minipage}[t]{0.4\textwidth}
% 	\vspace{0pt}
% 	\centering
% 	\includetikz{./figures/tikz/contDynamics/example_reachBackward}
% \end{minipage}
\end{center}
